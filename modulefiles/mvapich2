#%Module 1.0
#
#  MVAPICH2 module for use with 'environment-modules' package:
# 

# Only allow one mpi module to be loaded at a time
conflict mvapich2.3rc2-ankur
conflict mpich2-intel
conflict mpich2-local
conflict mvapich2-1.6
conflict mvapich2-1.7
conflict openmpi
conflict mpi/mpich-3.0-x86_64
conflict mpi/mpich-3.2-x86_64
conflict mpi/mpich-x86_64
conflict mpi/openmpi-x86_64

setenv        MPI_BIN       /usr/mpi/gcc/mvapich2-2.1a/bin
setenv        MPI_INCLUDE   /usr/mpi/gcc/mvapich2-2.1a/include/
setenv        MPI_LIB       /usr/mpi/gcc/mvapich2-2.1a/lib
setenv        MPI_MAN       /usr/mpi/gcc/mvapich2-2.1a/share/man
setenv        MPI_COMPILER  mvapich2-2.1a
setenv        MPI_HOME      /usr/mpi/gcc/mvapich2-2.1a/
prepend-path  PATH          /usr/mpi/gcc/mvapich2-2.1a/bin
prepend-path  LD_LIBRARY_PATH /usr/mpi/gcc/mvapich2-2.1a/lib
prepend-path  MANPATH       :/usr/mpi/gcc/mvapich2-2.1a/share/man
prepend-path  PKG_CONFIG_PATH /usr/mpi/gcc/mvapich2-2.1a/lib/pkgconfig

setenv MV2_ENABLE_AFFINITY 0
setenv MV2_SHOW_CPU_BINDING 1

# May be needed
setenv        LD_PRELOAD       /usr/mpi/gcc/mvapich2-2.1a/lib/libmpi.so

# Load nest for this one
module load nest-mvapich2
